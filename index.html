<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible"
          content="ie=edge">
    <title>로또 시뮬레이터 | 로또 확률 계산기</title>
    <script type="text/javascript"
            src="./lib/jquery-3.3.1.min.js"></script>
</head>
<body>
<h1 class="main-title" style="margin-bottom: 10px;">Lotto... Lotto is Ruthless...</h1>
<h4 style="margin-top: 0px;">좋은 꿈 꿔서 로또 10만원 어치 샀는데 5등 하나 돼서 빡쳐서 만들었습니다</h4>
<div class="main-wrap">
    <div class="left-wrap">
        <div class="roulette-wrap">
            <h3 class="sub-title">룰렛</h3>
            <table class="roulette-table">
                <thead>
                <tr>
                    <td>
                        동시에 돌릴 게임 수
                        <select name=""
                                id="running-game-count">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5" selected>5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                        </select>
                    </td>
                    <td>
                        <button id="btn-switch">시작</button>
                        <button id="btn-reset">초기화</button>
                    </td>
                </tr>
                </thead>
                <tr>
                    <th style="width: 209px;">현재 <span id="total-runned-count">0</span>회차</th>
                    <th>당첨번호 :
                        <span id="winningnumber-0">00</span>,
                        <span id="winningnumber-1">00</span>,
                        <span id="winningnumber-2">00</span>,
                        <span id="winningnumber-3">00</span>,
                        <span id="winningnumber-4">00</span>,
                        <span id="winningnumber-5">00</span> | 보너스 :
                        <span id="winningnumber-b">00</span></th>
                </tr>
                <tr>
                    <td colspan="2">
                        <h3>진행 현황</h3>
                    </td>
                </tr>
                <tbody id="roullete-body">
                <tr id="running-slot-1">
                    <td>
                        1번 슬롯
                    </td>
                    <td>
                        <input class="inner-slot 1" type="number" value="00">
                        <input class="inner-slot 2" type="number" value="00">
                        <input class="inner-slot 3" type="number" value="00">
                        <input class="inner-slot 4" type="number" value="00">
                        <input class="inner-slot 5" type="number" value="00">
                        <input class="inner-slot 6" type="number" value="00">
                        <input type="checkbox" class="auto-checkbox" checked>(자동)
                    </td>
                </tr>
                <tr id="running-slot-2">
                    <td>
                        2번 슬롯
                    </td>
                    <td>
                        <input class="inner-slot 1" type="number" value="00">
                        <input class="inner-slot 2" type="number" value="00">
                        <input class="inner-slot 3" type="number" value="00">
                        <input class="inner-slot 4" type="number" value="00">
                        <input class="inner-slot 5" type="number" value="00">
                        <input class="inner-slot 6" type="number" value="00">
                        <input type="checkbox" class="auto-checkbox" checked>(자동)
                    </td>
                </tr>
                <tr id="running-slot-3">
                    <td>
                        3번 슬롯
                    </td>
                    <td>
                        <input class="inner-slot 1" type="number" value="00">
                        <input class="inner-slot 2" type="number" value="00">
                        <input class="inner-slot 3" type="number" value="00">
                        <input class="inner-slot 4" type="number" value="00">
                        <input class="inner-slot 5" type="number" value="00">
                        <input class="inner-slot 6" type="number" value="00">
                        <input type="checkbox" class="auto-checkbox" checked>(자동)
                    </td>
                </tr>
                <tr id="running-slot-4">
                    <td>
                        4번 슬롯
                    </td>
                    <td>
                        <input class="inner-slot 1" type="number" value="00">
                        <input class="inner-slot 2" type="number" value="00">
                        <input class="inner-slot 3" type="number" value="00">
                        <input class="inner-slot 4" type="number" value="00">
                        <input class="inner-slot 5" type="number" value="00">
                        <input class="inner-slot 6" type="number" value="00">
                        <input type="checkbox" class="auto-checkbox" checked>(자동)
                    </td>
                </tr>
                <tr id="running-slot-5">
                    <td>
                        5번 슬롯
                    </td>
                    <td>
                        <input class="inner-slot 1" type="number" value="00">
                        <input class="inner-slot 2" type="number" value="00">
                        <input class="inner-slot 3" type="number" value="00">
                        <input class="inner-slot 4" type="number" value="00">
                        <input class="inner-slot 5" type="number" value="00">
                        <input class="inner-slot 6" type="number" value="00">
                        <input type="checkbox" class="auto-checkbox" checked>(자동)
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <!--end of roulette wrap-->
        <div class="total-wrap">
            <h3 class="sub-title">종합</h3>
            <table class="total-table">
                <thead></thead>
                <tbody>
                <tr>
                    <td>총 시도 횟수</td>
                    <td><span class="number" id="total-tried-count">0</span><span style="padding-right: 0px;" class="unit">회</span></td>
                </tr>
                <tr>
                    <td>총 사용 금액</td>
                    <td><span class="number" id="total-spended-money">0</span><span style="padding-right: 0px;" class="unit">원</span>
                    </td>
                </tr>
                <tr>
                    <td>총 소득 금액</td>
                    <td><span class="number" id="profit">0</span><span style="padding-right: 0px;" class="unit">원</span></td>
                </tr>
                <tr>
                    <td>손익</td>
                    <td><span class="number" id="pnl">0</span><span style="padding-right: 0px;" class="unit">원</span>
                    </td>
                </tr>
                <tr>
                    <td>소요 시간</td>
                    <td>
                        <input type="number" value="00" style="width: 30px;" id="spended-year">년
                        <input type="number" value="00" style="width: 30px;" id="spended-month">개월
                        <input type="number" value="00" style="width: 30px; padding-right: 0px;" id="spended-day">일
                    </td>
                </tr>
                </tbody>
            </table>
            <div>
                <i>(※1등 20억, 2등 5천만원, 3등 150만원, 4등 5만원, 5등 5천원으로 계산됩니다.)</i>
            </div>
            <h3 class="sub-title">. . .</h3>
        </div>
    </div>
    <!--end of left wrap-->

    <div class="result-wrap">
        <h3 class="sub-title">결과</h3>
        <table class="result-table">
            <thead>
            </thead>
            <tbody>
            <tr>
                <td rowspan="3">1등</td>
                <td class="notice">
                    당첨 횟수
                </td>
                <td>
                    <span id="grade-count-1">0</span><span style="padding-right: 0px;">회</span><br/>
                </td>
            </tr>
            <tr>
                <td class="notice">
                    당첨 백분율
                </td>
                <td>
                    <span id="grade-rate-1">0</span><span style="padding-right: 0px;">%</span><br/>
                </td>
            </tr>
            <tr>
                <td class="notice">
                    이론상 확률
                </td>
                <td>
                    <span>0.000012</span><span style="padding-right: 0px;">%</span><br/>
                </td>
            </tr>
            <tr>
                <td rowspan="3">2등</td>
                <td class="notice">
                    당첨 횟수
                </td>
                <td>
                    <span id="grade-count-2">0</span><span style="padding-right: 0px;">회</span><br/>
                </td>
            </tr>
            <tr>
                <td class="notice">
                    당첨 백분율
                </td>
                <td>
                    <span id="grade-rate-2">0</span><span style="padding-right: 0px;">%</span><br/>
                </td>
            </tr>
            <tr>
                <td class="notice">
                    이론상 확률
                </td>
                <td>
                    <span>0.000073</span><span style="padding-right: 0px;">%</span><br/>
                </td>
            </tr>
            <tr>
                <td rowspan="3">3등</td>
                <td class="notice">
                    당첨 횟수
                </td>
                <td>
                    <span id="grade-count-3">0</span><span style="padding-right: 0px;">회</span><br/>
                </td>
            </tr>
            <tr>
                <td class="notice">
                    당첨 백분율
                </td>
                <td>
                    <span id="grade-rate-3">0</span><span style="padding-right: 0px;">%</span><br/>
                </td>
            </tr>
            <tr>
                <td class="notice">
                    이론상 확률
                </td>
                <td>
                    <span>0.002799</span><span style="padding-right: 0px;">%</span><br/>
                </td>
            </tr>
            <tr>
                <td rowspan="3">4등</td>
                <td class="notice">
                    당첨 횟수
                </td>
                <td>
                    <span id="grade-count-4">0</span><span style="padding-right: 0px;">회</span><br/>
                </td>
            </tr>
            <tr>
                <td class="notice">
                    당첨 백분율
                </td>
                <td>
                    <span id="grade-rate-4">0</span><span style="padding-right: 0px;">%</span><br/>
                </td>
            </tr>
            <tr>
                <td class="notice">
                    이론상 확률
                </td>
                <td>
                    <span>0.136425</span><span style="padding-right: 0px;">%</span><br/>
                </td>
            </tr>
            <tr>
                <td rowspan="3">5등</td>
                <td class="notice">
                    당첨 횟수
                </td>
                <td>
                    <span id="grade-count-5">0</span><span style="padding-right: 0px;">회</span><br/>
                </td>
            </tr>
            <tr>
                <td class="notice">
                    당첨 백분율
                </td>
                <td>
                    <span id="grade-rate-5">0</span><span style="padding-right: 0px;">%</span><br/>
                </td>
            </tr>
            <tr>
                <td class="notice">
                    이론상 확률
                </td>
                <td>
                    <span>2.222222</span><span style="padding-right: 0px;">%</span><br/>
                </td>
            </tr>
            <tr>
                <td rowspan="3">꽝</td>
                <td class="notice">
                    당첨 횟수
                </td>
                <td>
                    <span id="grade-count-0">0</span><span style="padding-right: 0px;">회</span><br/>
                </td>
            </tr>
            <tr>
                <td class="notice">
                    꽝 백분율
                </td>
                <td>
                    <span id="grade-rate-0">0</span><span style="padding-right: 0px;">%</span><br/>
                </td>
            </tr>
            <tr>
                <td class="notice">
                    이론상 확률
                </td>
                <td>
                    <span>97.638469</span><span style="padding-right: 0px;">%</span><br/>
                </td>
            </tr>

            </tbody>
        </table>
        <h3 class="sub-title">결과 2</h3>
        <table class="fun-table">
            <thead></thead>
            <tbody>
            <tr>
                <td>치킨</td>
                <td>0마리</td>
            </tr>
            </tbody>
        </table>
    </div>

</div>
</body>
</html>
<style>
    .fun-table tr :first-child {
        width: 206px;
        height: 24px;
    }

    .fun-table {
        width: 100%;
    }

    .notice {
        text-align: left;
        padding-left: 5px;
    }

    .result-table {
        width: 100%;
    }

    .result-table tr :first-child {
        width: 100px;
        height: 24px;
    }

    .result-table tr td span {
        padding-right: 10px;
    }

    .result-table tr :last-child {
        text-align: right;
        padding-right: 20px;
    }

    .total-table {
        width: 100%;
    }

    .total-table tr :first-child {
        width: 212px;
    }

    .total-table tr :last-child {
        text-align: right;
        padding-right: 20px;
    }

    .total-table tr td span {
        padding-right: 10px;
    }

    .left-wrap {
        float: left;
        height: 100%;
        width: 588px;
    }

    .total-wrap {
        width: 588px;
        border: 1px solid black;
        float: left;
        height: 498px;
    }

    .inner-slot {
        width: 35px;
    }

    table, th, td {
        border: 1px solid black;
        border-collapse: collapse;
    }

    .roulette-table {
        width: 100%;
    }

    .main-title {
        font-family: 'Noto Sans CJK KR Black', sans-serif;
        font-style: italic;
        font-size: 60px;
    }

    .sub-title {
        font-family: 'Noto Sans CJK KR Black', sans-serif;
        font-size: 30px;
        margin: 10px;
    }

    .main-wrap {
        border: 1px solid black;
        width: 1180px;
        height: 1000px;
        margin: 0 auto;
    }

    body {
        margin: 0 auto;
        text-align: center;
    }

    .roulette-wrap {
        border: 1px solid black;
        width: 588px;
        float: left;
        height: 500px;
    }

    .result-wrap {
        border: 1px solid black;
        width: 590px;
        height: 1000px;
        float: left;
    }

</style>
<script>
    //전역변수 초기화
    var roullette = null;
    var totalRunnedCount = 0;
    var totalTriedCount = 0;
    var profitAndLoss = 0;
    var results = {
        0: 0,
        1: 0,
        2: 0,
        3: 0,
        4: 0,
        5: 0
    };
    var resultMoney = {
        0 : 0,
        1 : 2000000000,
        2 : 50000000,
        3 : 1500000,
        4 : 50000,
        5 : 5000
    }

    //선언
    class WinningNumber {
        constructor(winningNumbers, bonusNumber) {
            this.winningNumbers = winningNumbers;
            this.bonusNumber = bonusNumber;
        }

        getElements() {
            return {
                winningNumbers: this.winningNumbers,
                bonusNumber: this.bonusNumber
            }
        }
    }//end of WinningNumber


    function randNumberMaker(length) {
        var selectedNumbers = [];

        for (var i = 0; selectedNumbers.length < length;) {
            var managedNumber = getRandNumBetween(1, 45);
            if (selectedNumbers.includes(managedNumber)) {
                continue;
            } else {
                selectedNumbers.push(managedNumber);
            }
        }
        selectedNumbers.sort(function (a, b) {
            return a - b
        });
        return selectedNumbers;
    }//end of function randNumberMaker


    function rollTheRoullette(winningNumber) {
        var selectedNumbers = randNumberMaker(6);
        return lottoWinChecker(winningNumber, selectedNumbers);
    }//end of function rollTheRoullette


    function lottoWinChecker(winningNumber, selectedNumbers) {
        var {winningNumbers} = winningNumber.getElements();
        var {bonusNumber} = winningNumber.getElements();
        var equalNumberCount = 0;
        var bonusNumberAgreement = false;
        var resultGrade = 0;
        var numbersUnion = Array.from(new Set(winningNumbers.concat(selectedNumbers)));

        equalNumberCount = 12 - numbersUnion.length;
        bonusNumberAgreement = selectedNumbers.includes(bonusNumber) ? true : false;

        if (equalNumberCount === 6) {
            resultGrade = 1;
        } else if (equalNumberCount === 5 && bonusNumberAgreement) {
            resultGrade = 2;
        } else if (equalNumberCount === 5) {
            resultGrade = 3;
        } else if (equalNumberCount === 4) {
            resultGrade = 4;
        } else if (equalNumberCount === 3) {
            resultGrade = 5;
        }
        return resultGrade;
    }


    function getRandNumBetween(n1, n2) {
        return Math.floor((Math.random() * (n2 - n1 + 1)) + n1);
    }


    function on() {
        jQuery('#btn-switch').text('정지');
        currentCountRunningGame = jQuery('#running-game-count').val();
        roullette = setInterval(function () {
            var winningNumbers = randNumberMaker(7);
            var bonusNumberIndex = getRandNumBetween(0, winningNumbers.length - 1);
            var bonusNumber = winningNumbers[bonusNumberIndex];
            winningNumbers.splice(bonusNumberIndex, 1);
            var winningNumber = new WinningNumber(winningNumbers, bonusNumber);
            totalRunnedCount++;
            for(var i = 0; i < currentCountRunningGame ; i ++){
                totalTriedCount++;
                var currentManagedSelectedNumber = randNumberMaker(6);
                for(var j = 0; j < 6; j++){
                    jQuery('#running-slot-'+(i+1)).find('.inner-slot.'+ (j+1)).val(currentManagedSelectedNumber[j]);
                }
                results[lottoWinChecker(winningNumber, currentManagedSelectedNumber)]++;
            }
            console.log(results);
            updateBoard(winningNumber);
        }, 1);
    }

    function updateBoard(winningNumber) {
        var {winningNumbers} = winningNumber.getElements();
        var {bonusNumber} = winningNumber.getElements();
        var totalSpendedMoney = totalTriedCount * 1000;
        var totalSpendedDay = dateCalculator(totalRunnedCount * 7);
        var profit = calcProfit();

        jQuery('#total-runned-count').text(totalRunnedCount);
        for (var i = 0; i < 6; i++){
            jQuery('#grade-count-' + i).text(results[i]);
            var gradeRate = (results[i] / totalTriedCount) * 100;
            jQuery('#grade-rate-' + i).text(gradeRate.toFixed(6));
            jQuery('#winningnumber-' + i).text(winningNumbers[i]);
        }
        jQuery('#winningnumber-b').text(bonusNumber);
        jQuery('#total-tried-count').text(totalTriedCount);
        jQuery('#total-spended-money').text(totalSpendedMoney);
        jQuery('#profit').text(profit);
        jQuery('#pnl').text(profit - totalSpendedMoney);

    }

    var spendedYear = 0;
    var spendedMonth = 0;
    var spendedDay = 0;

    function dateCalculator(daySpended) {
        spendedYear = parseInt(daySpended / 365);
        var restDate = daySpended % 365;
        if(restDate){
            spendedMonth = parseInt(restDate / 30);
            restDate = restDate % 30;
        }
        spendedDay = restDate ? restDate : 1;

        jQuery('#spended-year').val(spendedYear);
        jQuery('#spended-month').val(spendedMonth);
        jQuery('#spended-day').val(spendedDay);
    }

    function calcProfit(){
        var moneyCalculated = 0;
        for (var i = 0; i < 6; i++){
            moneyCalculated += results[i] * resultMoney[i];
        }
        return moneyCalculated;
    }

    function off() {
        jQuery('#btn-switch').text('시작');
        clearInterval(roullette);
    }


    var running = false;
    var currentCountRunningGame = 0;

    //jQueryStart
    $(document).ready(function () {

        jQuery('#btn-switch').click(function (e) {
            running = !running;
            if (running) {
                on();
            } else {
                off();
            }
        });

        jQuery('#btn-reset').click(function (e) {
            alert('u just pressed reset btn');
        });


        jQuery('#running-game-count').change(function (e) {
            currentCountRunningGame = jQuery('#running-game-count').val();
            var madeHTML = '';

            for (var i = 0; i < currentCountRunningGame; i++) {
                madeHTML += '<tr id="running-slot-' + (i + 1) + '">\n' +
                    '              <td>\n' +
                    '                  ' + (i + 1) + '번 슬롯\n' +
                    '              </td>\n' +
                    '              <td>\n' +
                    '                  <input class="inner-slot 1" type="number" value="00">\n' +
                    '                  <input class="inner-slot 2" type="number" value="00">\n' +
                    '                  <input class="inner-slot 3" type="number" value="00">\n' +
                    '                  <input class="inner-slot 4" type="number" value="00">\n' +
                    '                  <input class="inner-slot 5" type="number" value="00">\n' +
                    '                  <input class="inner-slot 6" type="number" value="00">\n' +
                    '                  <input type="checkbox" class="auto-checkbox" checked>(자동)\n' +
                    '              </td>\n' +
                    '          </tr>';
            }

            jQuery('#roullete-body').html(madeHTML);
        });

    });
    //jQueryEnd
</script>